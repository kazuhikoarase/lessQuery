{"version":3,"file":"lessq.mjs","sources":["../src/lessq.ts"],"sourcesContent":["//\n// lessQuery\n//\n// Copyright (c) 2017 Kazuhiko Arase\n//\n// URL: http://www.d-project.com/\n//\n// Licensed under the MIT license:\n//  http://www.opensource.org/licenses/mit-license.php\n//\n\nconst debug = location.hash == '#debug';\n\nconst cacheIdKey = '.lessqCacheId';\nlet cacheIdSeq = 0;\nconst cache : any = {};\n\nconst getCache = function(elm : any) {\n  let cacheId = elm[cacheIdKey];\n  if (typeof cacheId == 'undefined') {\n    elm[cacheIdKey] = cacheId = cacheIdSeq++;\n    cache[cacheId] = debug? { e : elm } : {};\n  }\n  return cache[cacheId];\n};\n\nconst hasCache = function(elm : any) {\n  return typeof elm[cacheIdKey] != 'undefined';\n};\n\nif (debug) {\n  let lastKeys : any = {};\n  const showCacheCount = function() {\n    let cnt = 0;\n    let keys : any = {};\n    for (let k in cache) {\n      cnt += 1;\n      if (!lastKeys[k]) {\n        console.log(cache[k]);\n      }\n      keys[k] = true;\n    }\n    lastKeys = keys;\n    console.log('cacheCount:' + cnt);\n    window.setTimeout(showCacheCount, 5000);\n  };\n  showCacheCount();\n}\n\nconst removeCache = function(elm : any) {\n\n  if (typeof elm[cacheIdKey] != 'undefined') {\n\n    // remove all listeners\n    const cacheId = elm[cacheIdKey];\n    const listenerMap = cache[cacheId].listenerMap;\n    for (let type in listenerMap) {\n      const listeners = listenerMap[type];\n      for (let i = 0; i < listeners.length; i += 1) {\n        elm.removeEventListener(type, listeners[i]);\n      }\n    }\n\n    // delete refs\n    delete elm[cacheIdKey];\n    delete cache[cacheId];\n  }\n\n  while (elm.firstChild) {\n    removeCache(elm.firstChild);\n    elm.removeChild(elm.firstChild);\n  }\n};\n\nconst getData = function(elm : any) {\n  if (!getCache(elm).data) { getCache(elm).data = {}; }\n  return getCache(elm).data;\n};\n\nconst getListeners = function(elm : any, type : string) {\n  if (!getCache(elm).listenerMap) {\n    getCache(elm).listenerMap = {}; }\n  if (!getCache(elm).listenerMap[type]) {\n    getCache(elm).listenerMap[type] = []; }\n  return getCache(elm).listenerMap[type];\n};\n\n// add / remove event listener.\nconst addEventListener = function(elm : any, type : string, listener : () => void, add : boolean) {\n  const listeners = getListeners(elm, type);\n  const newListeners = [];\n  for (let i = 0; i < listeners.length; i += 1) {\n    if (listeners[i] != listener) {\n      newListeners.push(listeners[i]);\n    }\n  }\n  if (add) { newListeners.push(listener); }\n  getCache(elm).listenerMap[type] = newListeners;\n  return true;\n};\n\nconst CustomEvent : any = {\n  preventDefault : function() { this._pD = true; },\n  stopPropagation : function() { this._sP = true; },\n  stopImmediatePropagation : function() { this._sIp = true; }\n};\n\nconst trigger = function(elm : any, type : string, data : any) {\n  const event = { type : type, target : elm, currentTarget : null,\n      _pD : false, _sP : false, _sIp : false, __proto__ : CustomEvent };\n  for (let e = elm; e != null; e = e.parentNode) {\n    if (!hasCache(e) ) { continue; }\n    if (!getCache(e).listenerMap) { continue; }\n    if (!getCache(e).listenerMap[type]) { continue; }\n    event.currentTarget = e;\n    const listeners = getCache(e).listenerMap[type];\n    for (let i = 0; i < listeners.length; i += 1) {\n      listeners[i].call(e, event, data);\n      if (event._sIp) { return; }\n    }\n    if (event._sP) { return; }\n  }\n};\n\nconst data = function(elm : any, kv : any) {\n  if (arguments.length == 2) {\n    if (typeof kv == 'string') return getData(elm)[kv];\n    for (let k in kv) { getData(elm)[k] = kv[k]; }\n  } else if (arguments.length == 3) {\n    getData(elm)[kv] = arguments[2];\n  }\n  return elm;\n};\n\n//type Extend<S, T extends S> = (o1 : S, o2: T) => T;\n\nconst extend = function<S,T, U extends S & T>(o1 : S, o2 : T) : U {\n  const _o1 : any = o1;\n  for (let k in o2) { _o1[k] = o2[k]; } return _o1;\n};\n\nconst each = function(it : any, callback : (i : number | string, o : any) => void) {\n  if (typeof it.splice == 'function') {\n    for (let i = 0; i < it.length; i += 1) { callback(i, it[i]); }\n  } else {\n    for (let k in it) { callback(k, it[k]); }\n  }\n};\n\nconst grep = function(list : any[], accept : (o : any) => boolean) {\n  const newList = [];\n  for (let i = 0; i < list.length; i += 1) {\n    const item = list[i];\n    if (accept(item) ) {\n      newList.push(item);\n    }\n  }\n  return newList;\n};\n\nconst addClass = function(elm : any, className : string, add? : boolean) {\n  const classes = (elm.getAttribute('class') || '').split(/\\s+/g);\n  let newClasses = '';\n  for (let i = 0; i < classes.length; i+= 1) {\n    if (classes[i] == className) { continue; }\n    newClasses += ' ' + classes[i];\n  }\n  if (add) { newClasses += ' ' + className; }\n  elm.setAttribute('class', newClasses);\n};\n\nconst hasClass = function(elm : any, className : string) {\n  const classes = (elm.getAttribute('class') || '').split(/\\s+/g);\n  for (let i = 0; i < classes.length; i+= 1) {\n    if (classes[i] == className) { return true; }\n  }\n  return false;\n};\n\nconst matches = function(elm : any, selector : string) {\n  if (elm.nodeType != 1) {\n    return false;\n  } else if (!selector) {\n    return true;\n  }\n  const sels = selector.split(/[,\\s]+/g);\n  for (let i = 0; i < sels.length; i += 1) {\n    const sel = sels[i];\n    if (sel.substring(0, 1) == '#') {\n      throw 'not supported:' + sel;\n    } else if (sel.substring(0, 1) == '.') {\n      if (hasClass(elm, sel.substring(1) ) ) {\n        return true;\n      }\n    } else {\n      if (elm.tagName.toUpperCase() == sel.toUpperCase() ) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\nconst parser = new window.DOMParser();\n\nconst html = function(html : string) {\n  const doc : any = parser.parseFromString(\n      '<div xmlns=\"http://www.w3.org/1999/xhtml\">' + html + '</div>',\n      'text/xml').firstChild;\n  const elms : any = [];\n  while (doc.firstChild) {\n    elms.push(doc.firstChild);\n    doc.removeChild(doc.firstChild);\n  }\n  elms.__proto__ = fn;\n  return elms;\n};\n\nconst pxToNum = function(px : any) {\n  if (typeof px != 'string' || px.length <= 2 ||\n      px.charAt(px.length - 2) != 'p' ||\n      px.charAt(px.length - 1) != 'x') {\n    throw 'illegal px:' + px;\n  }\n  return +px.substring(0, px.length - 2);\n};\n\nconst buildQuery = function(data : any) {\n  let query = '';\n  for (let k in data) {\n    if (query.length > 0) {\n      query += '&';\n    }\n    query += window.encodeURIComponent(k);\n    query += '=';\n    query += window.encodeURIComponent(data[k]);\n  }\n  return query;\n};\n\nconst parseResponse = function(this : any) {\n\n    let contentType = this.getResponseHeader('content-type');\n  if (contentType != null) {\n    contentType = contentType.replace(/\\s*;.+$/, '').toLowerCase();\n  }\n\n  if (contentType == 'text/xml' ||\n        contentType == 'application/xml') {\n    return parser.parseFromString(this.responseText, 'text/xml');\n  } else if (contentType == 'text/json' ||\n      contentType == 'application/json') {\n    return JSON.parse(this.responseText);\n  } else {\n    return this.response;\n  }\n};\n\nconst ajax = function(params : any) {\n\n  params = extend({\n    url: '',\n    method : 'GET',\n    contentType : 'application/x-www-form-urlencoded;charset=UTF-8',\n    cache: true,\n    processData: true,\n    async : true\n  }, params);\n\n  if (!params.async) {\n    // force async.\n    throw 'not supported.';\n  }\n\n  const method = params.method.toUpperCase();\n  let data = null;\n  let contentType = params.contentType;\n  if (method == 'POST' || method == 'PUT') {\n    data = (typeof params.data == 'object' && params.processData)?\n        buildQuery(params.data) : params.data;\n  } else {\n    contentType = false;\n  }\n\n  const xhr = params.xhr? params.xhr() : new window.XMLHttpRequest();\n  xhr.open(method, params.url, params.async);\n  if (contentType !== false) {\n    xhr.setRequestHeader('Content-Type', contentType);\n  }\n  xhr.onreadystatechange = function() {\n    if(xhr.readyState == window.XMLHttpRequest.DONE) {\n      try {\n        if (xhr.status == 200) {\n          done.call(xhr, parseResponse.call(this) );\n        } else {\n          fail.call(xhr);\n        }\n      } finally {\n        always.call(xhr);\n      }\n    }\n  };\n\n  // call later\n  window.setTimeout(function() { xhr.send(data); }, 0);\n\n  // callbacks\n  let done = function(_data : any) {};\n  let fail = function() {};\n  let always = function() {};\n\n  const $ = {\n    done : function(callback : any) { done = callback; return $; },\n    fail : function(callback : any) { fail = callback; return $; },\n    always : function(callback : any) { always = callback; return $; },\n    abort : function() { xhr.abort(); return $; }\n  };\n  return $;\n};\n\n// 1. for single element\nlet fn = {\n  attr : function(this : any, kv : any) {\n    if (arguments.length == 1) {\n      if (typeof kv == 'string') return this.getAttribute(kv);\n      for (let k in kv) { this.setAttribute(k, kv[k]); }\n    } else if (arguments.length == 2) {\n      this.setAttribute(kv, arguments[1]);\n    }\n    return this;\n  },\n  prop : function(this : any, kv : any) {\n    if (arguments.length == 1) {\n      if (typeof kv == 'string') return this[kv];\n      for (let k in kv) { this[k] = kv[k]; }\n    } else if (arguments.length == 2) {\n      this[kv] = arguments[1];\n    }\n    return this;\n  },\n  css : function(this : any, kv : any) {\n    if (arguments.length == 1) {\n      if (typeof kv == 'string') return this.style[kv];\n      for (let k in kv) { this.style[k] = kv[k]; }\n    } else if (arguments.length == 2) {\n      this.style[kv] = arguments[1];\n    }\n    return this;\n  },\n  data : function(this : any, _kv : any) {\n    const args : any = [ this ];\n    for (let i = 0; i < arguments.length; i += 1) {\n      args.push(arguments[i]);\n    }; \n    return data.apply(null, args);\n  },\n  val : function(this : any) {\n    if (arguments.length == 0) {\n      return this.value || '';\n    } else if (arguments.length == 1) {\n      this.value = arguments[0];\n    }\n    return this;\n  },\n  on : function(this : any, type : string, listener : any) {\n    const types = type.split(/\\s+/g);\n    for (let i = 0; i < types.length; i += 1) {\n      this.addEventListener(types[i], listener);\n      addEventListener(this, types[i], listener, true);\n    }\n    return this;\n  },\n  off : function(this : any, type : string, listener : any) {\n    const types = type.split(/\\s+/g);\n    for (let i = 0; i < types.length; i += 1) {\n      this.removeEventListener(types[i], listener);\n      addEventListener(this, types[i], listener, false);\n    }\n    return this;\n  },\n  trigger : function(type : string, data : any) {\n    trigger(this, type, data);\n    return this;\n  },\n  offset : function(this : any) {\n    const off = { left : 0, top : 0 };\n    let base = null;\n    for (let e = this; e.parentNode != null; e = e.parentNode) {\n      if (e.offsetParent != null) {\n        base = e;\n        break;\n      }\n    }\n    if (base != null) {\n      for (let e = base; e.offsetParent != null; e = e.offsetParent) {\n        off.left += e.offsetLeft;\n        off.top += e.offsetTop;\n      }\n    }\n    for (let e = this; e.parentNode != null &&\n          e != document.body; e = e.parentNode) {\n      off.left -= e.scrollLeft;\n      off.top -= e.scrollTop;\n    }\n    return off;\n  },\n  append : function(this : HTMLElement, elms : any) {\n    if (typeof elms == 'string') {\n      elms = html(elms);\n    }\n    for (let i = 0; i < elms.length; i += 1) {\n      this.appendChild(elms[i]);\n    }\n    return this;\n  },\n  prepend : function(this : HTMLElement, elms : NodeList) {\n    if (typeof elms == 'string') {\n      elms = html(elms);\n    }\n    for (let i = 0; i < elms.length; i += 1) {\n      if (this.firstChild) {\n        this.insertBefore(elms[i], this.firstChild);\n      } else {\n        this.appendChild(elms[i]);\n      }\n    }\n    return this;\n  },\n  insertBefore : function(this : HTMLElement, elms : NodeList) {\n    const elm = elms[0];\n    elm.parentNode!.insertBefore(this, elm);\n    return this;\n  },\n  insertAfter : function(this : HTMLElement, elms : NodeList) {\n    const elm = elms[0];\n    if (elm.nextSibling) {\n      elm.parentNode!.insertBefore(this, elm.nextSibling);\n    } else {\n      elm.parentNode!.appendChild(this);\n    }\n    return this;\n  },\n  remove : function(this : HTMLElement) {\n    if (this.parentNode) { this.parentNode.removeChild(this); }\n    removeCache(this);\n    return this;\n  },\n  detach : function(this : HTMLElement) {\n    if (this.parentNode) { this.parentNode.removeChild(this); }\n    return this;\n  },\n  parent : function(this : HTMLElement) {\n    return $(this.parentNode);\n  },\n  closest : function(this : HTMLElement, selector : string) {\n    for (let e : Node = this; e != null; e = e.parentNode!) {\n      if (matches(e, selector) ) {\n        return $(e);\n      }\n    }\n    return $();\n  },\n  find : function(this : HTMLElement, selector : string) {\n    const elms : any = [];\n    const childNodes = this.querySelectorAll(selector);\n    for (let i = 0; i < childNodes.length; i += 1) {\n      elms.push(childNodes.item(i) );\n    }\n    elms.__proto__ = fn;\n    return elms;\n  },\n  children : function(this : HTMLElement, selector : string) {\n    const elms : any = [];\n    const childNodes = this.childNodes;\n    for (let i = 0; i < childNodes.length; i += 1) {\n      if (matches(childNodes.item(i), selector) ) {\n        elms.push(childNodes.item(i) );\n      }\n    }\n    elms.__proto__ = fn;\n    return elms;\n  },\n  index : function(selector : string) {\n    return Array.prototype.indexOf.call(\n        $(this).parent().children(selector), this);\n  },\n  clone : function(this : HTMLElement) { return $(this.cloneNode(true) ); },\n  focus : function() { this.focus(); return this; },\n  select : function() { this.select(); return this; },\n  submit : function() { this.submit(); return this; },\n  scrollLeft : function() {\n    if (arguments.length == 0) return this.scrollLeft;\n    this.scrollLeft = arguments[0]; return this;\n  },\n  scrollTop : function() {\n    if (arguments.length == 0) return this.scrollTop;\n    this.scrollTop = arguments[0]; return this;\n  },\n  html : function(this : HTMLElement) {\n    if (arguments.length == 0) return this.innerHTML;\n    this.innerHTML = arguments[0]; return this;\n  },\n  text : function(this : HTMLElement) {\n    if (typeof this.textContent != 'undefined') {\n      if (arguments.length == 0) return this.textContent;\n      this.textContent = arguments[0]; return this;\n    } else {\n      if (arguments.length == 0) return this.innerText;\n      this.innerText = arguments[0]; return this;\n    }\n  },\n  outerWidth : function(this : HTMLElement, margin? : boolean) {\n    const w = this.offsetWidth;\n    if (margin) {\n      const cs = window.getComputedStyle(this, null);\n      return w + pxToNum(cs.marginLeft) + pxToNum(cs.marginRight);\n    }\n    return w;\n  },\n  innerWidth : function(this : HTMLElement) {\n    const cs = window.getComputedStyle(this, null);\n    return this.offsetWidth -\n      pxToNum(cs.borderLeftWidth) - pxToNum(cs.borderRightWidth);\n  },\n  width : function(this : HTMLElement | Window) {\n    if (this == window) {\n      return this.innerWidth;\n    } else if (this instanceof HTMLElement) {\n      const cs = window.getComputedStyle(this, null);\n      return this.offsetWidth -\n        pxToNum(cs.borderLeftWidth) - pxToNum(cs.borderRightWidth) -\n        pxToNum(cs.paddingLeft) - pxToNum(cs.paddingRight);\n    } else {\n      throw this;\n    }\n  },\n  outerHeight : function(this : HTMLElement, margin? : boolean) {\n    const h = this.offsetHeight;\n    if (margin) {\n      const cs = window.getComputedStyle(this, null);\n      return h + pxToNum(cs.marginTop) + pxToNum(cs.marginBottom);\n    }\n    return h;\n  },\n  innerHeight : function(this : HTMLElement) {\n    const cs = window.getComputedStyle(this, null);\n    return this.offsetHeight -\n      pxToNum(cs.borderTopWidth) - pxToNum(cs.borderBottomWidth);\n  },\n  height : function(this : HTMLElement | Window) {\n    if (this == window) {\n      return this.innerHeight;\n    } else if (this instanceof HTMLElement) {\n      const cs = window.getComputedStyle(this, null);\n      return this.offsetHeight -\n        pxToNum(cs.borderTopWidth) - pxToNum(cs.borderBottomWidth) -\n        pxToNum(cs.paddingTop) - pxToNum(cs.paddingBottom);\n    } else {\n      throw this;\n    }\n  },\n  addClass : function(className : string) {\n    addClass(this, className, true); return this;\n  },\n  removeClass : function(className : string) {\n    addClass(this, className, false); return this;\n  },\n  hasClass : function(className : string) {\n    return hasClass(this, className);\n  }\n};\n\n// 2. to array\neach(fn, function(name, func) {\n  const _fn : any = fn;\n  _fn[name] = function() {\n    let newRet : any = null;\n    for (let i = 0; i < this.length; i += 1) {\n      const elm = this[i];\n      const ret = func.apply(elm, arguments);\n      if (elm !== ret) {\n        if (ret != null && ret.__proto__ == fn) {\n          if (newRet == null) { newRet = []; }\n          newRet = newRet.concat(ret);\n        } else {\n          return ret;\n        }\n      }\n    }\n    if (newRet != null) {\n      newRet.__proto__ = fn;\n      return newRet;\n    }\n    return this;\n  };\n});\n\n// 3. for array\nfn = extend(fn, {\n  each : function(this : any[], callback : (i : number) => void) {\n    for (let i = 0; i < this.length; i += 1) {\n      callback.call(this[i], i);\n    }\n    return this;\n  },\n  first : function(this : any[]) {\n    return $(this.length > 0? this[0] : null);\n  },\n  last : function(this : any[]) {\n    return $(this.length > 0? this[this.length - 1] : null);\n  }\n});\n\nconst $ = function(target? : any) : any {\n\n  if (typeof target == 'function') {\n\n    // ready\n    return $(document).on('DOMContentLoaded', target);\n\n  } else if (typeof target == 'string') {\n\n    if (target.charAt(0) == '<') {\n\n      // dom creation\n      return html(target);\n\n    } else {\n\n      // query\n      const childNodes = document.querySelectorAll(target);\n      const elms : any = [];\n      for (let i = 0; i < childNodes.length; i += 1) {\n        elms.push(childNodes.item(i) );\n      }\n      elms.__proto__ = fn;\n      return elms;\n    }\n\n  } else if (typeof target == 'object' && target != null) {\n\n    if (target.__proto__ == fn) {\n      return target;\n    } else {\n      const elms : any = [];\n      elms.push(target);\n      elms.__proto__ = fn;\n      return elms;\n    }\n\n  } else {\n\n    const elms : any = [];\n    elms.__proto__ = fn;\n    return elms;\n  }\n};\n\nconst lessQuery = extend($, {\n  fn : fn, extend : extend, each : each, grep : grep, data : data, ajax : ajax\n});\n\nexport default lessQuery;\n"],"names":["debug","cacheIdKey","cacheIdSeq","cache","getCache","elm","cacheId","hasCache","lastKeys","showCacheCount","cnt","keys","k","removeCache","listenerMap","type","listeners","i","getData","getListeners","addEventListener","listener","add","newListeners","CustomEvent","trigger","data","event","e","kv","extend","o1","o2","_o1","each","it","callback","grep","list","accept","newList","item","addClass","className","classes","newClasses","hasClass","matches","selector","sels","sel","parser","html","doc","elms","fn","pxToNum","px","buildQuery","query","parseResponse","contentType","ajax","params","method","xhr","done","fail","always","_data","$","_kv","args","types","off","base","childNodes","margin","w","cs","h","name","func","_fn","newRet","ret","target","lessQuery"],"mappings":"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"}